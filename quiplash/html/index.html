<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <link rel="stylesheet" href="/quiplash/static/css/styles.css">
    <link rel="stylesheet" href="/quiplash/static/css/index-style.css">

    <title>This is a test page</title>
</head>

<body>
    <h1>Enter Username</h1>
        <input type="text" id="username-input" required>
        <button class="button" onclick="sendUsername()">


            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5"
                stroke="currentColor" class="w-6 h-6">
                <path stroke-linecap="round" stroke-linejoin="round" d="M4.5 12h15m0 0l-6.75-6.75M19.5 12l-6.75 6.75">
                </path>
            </svg>


            <div class="text">
                Enter
            </div>

        </button>
    <script>
        function timer(startTime, amountOfTimeInMinutes) {
            let totalTimeInSeconds = ((startTime + amountOfTimeInMinutes * 60000) - new Date().getTime()) / 1000;
            for (let i = totalTimeInSeconds; i > 0; i--) {
                setTimeout(() => { console.log(i) }, (totalTimeInSeconds - i) * 1000);
            }
        }

        function sendUsername() {
            const playerUsername = document.querySelector("#username-input").value;
            fetch("/username", {
                method: "POST",
                headers: {
                    "Content-Type": "text/plain",
                },
                body: JSON.stringify({ txt: playerUsername })
            }).then((res) => {
                if (res.status === 200) { window.location.replace(window.location.href + res.headers.get("Location")); }
                else if (res.status === 500) {
                    let par = document.createElement('p');
                    par.className = "error";
                    par.appendChild(document.createTextNode("username taken"));
                    document.querySelector("body").appendChild(par);
                }
            });
        }

        // GET
        /*function onClickTest() {
            fetch('/l').then((res) => {
                if (res.ok)
                    return res.json()
                return res
            }).then(data => {document.querySelector("body").innerHTML = data["body"]; console.log(data)});
        }*/

        // POST
        /*fetch('https://reqres.in/api/users', {
            method: "POST",
            header: {
                'Content-Type': 'application/json'
            },
            body: JSON.stringify({
                name: 'User 1'
            })
        }).then((res) => {
            return res.json() 
        }).then(data => console.log(data))*/


    </script>
</body>

</html>